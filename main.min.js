function fetchTopStories(){const e=`${hnBaseUrl}/topstories.json`;return fetch(e).then(e=>e.json()).then(e=>fetchStories(e))}function fetchStories(e){const t=e.slice(0,29).map(e=>{const t=`${hnBaseUrl}/item/${e}.json`;return fetch(t).then(e=>e.json()).then(e=>e)});return Promise.all(t).then(e=>{state.stories=e,renderStories(e)})}function renderStories(e){return e.map(e=>{const t=`https://news.ycombinator.com/user?id=${e.by}`,n=`https://news.ycombinator.com/item?id=${e.id}`,s=`\n      <div class='story' id='${e.id}'>\n        <h3 class='title'>\n          ${e.url?`<a href='${e.url}' target='_blank'>${e.title}</a>`:`<a href='' onclick="toggleStoryText('${e.id}')" >${e.title}</a>`}\n        </h3>\n        <span class='score'> ${e.score} </span> points by\n        <a href='${t}' target='_blank' class='story-by'> ${e.by}</a>\n        <div class='toggle-view'>\n          ${e.kids?`\n            <span\n              onclick="fetchOrToggleComments('${e.kids}','${e.id}')"\n              class='comments'\n            > [toggle ${e.descendants} comments] </span>`:""}\n          <a href='${n}' target='_blank' class='hnLink'>[view on HN]</a>\n        </div>\n        ${e.text?`<p class='storyText' id='storyText-${e.id}' style='display:none;'> ${e.text} </p>`:""}\n        <div id='comments-${e.id}' style='display: block;'></div>\n      </div> `;document.getElementById("hn").insertAdjacentHTML("beforeend",s)})}function toggleStoryText(e){const t=document.getElementById(`storyText-${e}`);t.style.display="block"===t.style.display?"none":"block"}function fetchComments(e,t){const n=e.split(",").map(e=>{const t=`${hnBaseUrl}/item/${e}.json`;return fetch(t).then(e=>e.json()).then(e=>e)});return Promise.all(n).then(e=>{state[t]=e,renderComments(e,t)})}function fetchOrToggleComments(e,t){state[t]?function(e){const t=document.getElementById(`comments-${e}`);t.style.display="block"===t.style.display?"none":"block"}(t):fetchComments(e,t)}function toggleComment(e){const t=document.getElementById(e),n=document.getElementById(`toggle-${e}`);t.style.display="block"===t.style.display?"none":"block",n.innerHTML="[ - ]"===n.innerHTML?"[ + ]":"[ - ]"}function renderComments(e,t){return e.map(e=>{const n=`${hnUrl}/user?id=${e.by}`,s=e.deleted||e.dead?"":`\n      <div class='comment'>\n        <span\n          onclick='toggleComment("${e.id}")'\n          href='#'\n          id='toggle-${e.id}'\n          class='toggle-comment'\n        >[ - ]</span>\n        <a href='${n}' class='comment-by'> ${e.by}</a>\n        <div id=${e.id} class='comment-text' style='display:block;'>\n          ${e.text}\n        </div>\n      </div> `;if(e.parent==t?document.getElementById(`comments-${t}`).insertAdjacentHTML("beforeend",s):document.getElementById(e.parent).insertAdjacentHTML("beforeend",s),e.kids)return fetchComments(e.kids.toString(),t)})}const state={},hnBaseUrl="https://hacker-news.firebaseio.com/v0";fetchTopStories();